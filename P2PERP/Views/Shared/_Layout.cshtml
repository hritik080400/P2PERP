<!DOCTYPE html>

    @{
        Layout = null;
        string currentAction = ViewContext.RouteData.Values["action"].ToString();
        string currentController = ViewContext.RouteData.Values["controller"].ToString();
        string role = Session["RoleId"] != null ? Session["RoleId"].ToString() : ""; // fallback
    }
    <html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport"
              content="width=device-width, initial-scale=1.0, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0" />
        <meta name="robots" content="noindex, nofollow" />

        <title>@ViewBag.Title</title>

        <meta name="description" content="" />
        <!-- Favicon -->
        <link rel="icon" type="image/x-icon" href="~/Content/images/favicon/favicon.ico" />
        <!-- Fonts -->
        <link rel="preconnect" href="https://fonts.googleapis.com" />
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
        <link rel="stylesheet" href="~/Content/font-family-inter.css" />
        <link rel="stylesheet" href="~/Content/iconify-icons.css" />

        <!-- Core CSS -->
        <link rel="stylesheet" href="~/Content/node-waves.css" />
        <link rel="stylesheet" href="~/Content/core.css" />
        <link rel="stylesheet" href="~/Content/demo.css" />
        <link rel="stylesheet" href="~/Content/Site.css" />
        <link rel="stylesheet" href="~/Content/Layout.css" />

        <!-- Vendors CSS -->
        <link rel="stylesheet" href="~/Content/perfect-scrollbar.css" />
        <link rel="stylesheet" href="~/Content/apex-charts.css" />
        <link rel="stylesheet" href="~/Content/dataTables.dataTables.min.css" />
        <link rel="stylesheet" href="~/Content/buttons.dataTables.min.css" />
        @*<link rel="stylesheet" href="~/Content/dataTables.bootstrap5.min.css" />*@
        <link rel="stylesheet" href="~/Content/bootstrap-icons-1.11.3/package/font/bootstrap-icons.min.css">
        <link rel="stylesheet" href="~/Content/remixicon-4.6.0/package/fonts/remixicon.css" />
        <link rel="stylesheet" href="~/Content/jquery-ui.css" />
        <link rel="stylesheet" type="text/css" href="~/Content/daterangepicker.css" />
        <link rel="stylesheet" href="~/Content/toastr.min.css" />

        <!-- jQuery -->
        <script src="~/Scripts/jquery-3.7.1.min.js"></script>
        <script src="~/Scripts/jquery-ui.min.js"></script>

        <!-- Bootstrap & Popper -->
        <script src="~/Scripts/popper.js"></script>
        <script src="~/Scripts/bootstrap.bundle.min.js"></script>

        <!-- Plugins & Helpers -->
        <script src="~/Scripts/helpers.js"></script>
        <script src="~/Scripts/config.js"></script>
        <script src="~/Scripts/node-waves.js"></script>
        <script src="~/Scripts/perfect-scrollbar.js"></script>
        <script src="~/Scripts/menu.js"></script>

        <!-- DataTables & Export -->
        <script src="~/Scripts/dataTables.min.js"></script>
        <script src="~/Scripts/dataTables.buttons.min.js"></script>
        <script src="~/Scripts/jszip.min.js"></script>
        <script src="~/Scripts/pdfmake.min.js"></script>
        <script src="~/Scripts/vfs_fonts.js"></script>
        <script src="~/Scripts/buttons.html5.min.js"></script>
        <script src="~/Scripts/buttons.print.min.js"></script>
        @*<script src="~/Scripts/dataTables.bootstrap5.min.js"></script>*@

        <!-- Validation -->
        <script src="~/Scripts/jquery.validate.min.js"></script>
        <script src="~/Scripts/jquery.validate.unobtrusive.min.js"></script>

        <!-- Charts -->
        <script src="~/Scripts/highcharts.js"></script>
        <script src="~/Scripts/exporting.js"></script>
        <script src="~/Scripts/accessibility.js"></script>
        <script src="~/Scripts/apexcharts.js"></script>

        <!-- Date & Time -->
        <script src="~/Scripts/moment.min.js"></script>
        <script type="text/javascript" src="~/Scripts/daterangepicker.min.js"></script>

        <!-- Notifications -->
        <script src="~/Scripts/toastr.min.js"></script>
        <script src="~/Scripts/sweetalert2@11.js"></script>

        <!-- Calendar -->
        <script src="~/Scripts/fullcalendar@6.1.19_index.global.min.js"></script>
        <script src="~/Scripts/bootstrap5@6.1.19_index.global.min.js"></script>

        <!-- Main JS -->
        <script src="~/Scripts/main.js"></script>

        <!-- Page-specific JS -->
        <script src="~/Scripts/dashboards-analytics.js"></script>

    </head>
    <body>
        <!-- Layout wrapper -->
        <div class="layout-wrapper layout-content-navbar" style="position:fixed">
            <div class="layout-container scroll-container">

                <!-- Menu -->
                <aside id="layout-menu" class="layout-menu menu-vertical menu bg-menu-theme">
                    <div class="app-brand demo">
                        <a href="index" class="app-brand-link">
                            <span class="app-brand-logo demo me-1">
                                <span class="text-primary">
                                    <svg width="30" height="24" viewBox="0 0 250 196" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <path fill-rule="evenodd" clip-rule="evenodd" d="M12.3002 1.25469L56.655 28.6432C59.0349 30.1128 60.4839 32.711 60.4839 35.5089V160.63C60.4839 163.468 58.9941 166.097 56.5603 167.553L12.2055 194.107C8.3836 196.395 3.43136 195.15 1.14435 191.327C0.395485 190.075 0 188.643 0 187.184V8.12039C0 3.66447 3.61061 0.0522461 8.06452 0.0522461C9.56056 0.0522461 11.0271 0.468577 12.3002 1.25469Z" fill="currentColor" />
                                        <path opacity="0.077704" fill-rule="evenodd" clip-rule="evenodd" d="M0 65.2656L60.4839 99.9629V133.979L0 65.2656Z" fill="black" />
                                        <path opacity="0.077704" fill-rule="evenodd" clip-rule="evenodd" d="M0 65.2656L60.4839 99.0795V119.859L0 65.2656Z" fill="black" />
                                        <path fill-rule="evenodd" clip-rule="evenodd" d="M237.71 1.22393L193.355 28.5207C190.97 29.9889 189.516 32.5905 189.516 35.3927V160.631C189.516 163.469 191.006 166.098 193.44 167.555L237.794 194.108C241.616 196.396 246.569 195.151 248.856 191.328C249.605 190.076 250 188.644 250 187.185V8.09597C250 3.64006 246.389 0.027832 241.935 0.027832C240.444 0.027832 238.981 0.441882 237.71 1.22393Z" fill="currentColor" />
                                        <path opacity="0.077704" fill-rule="evenodd" clip-rule="evenodd" d="M250 65.2656L189.516 99.8897V135.006L250 65.2656Z" fill="black" />
                                        <path opacity="0.077704" fill-rule="evenodd" clip-rule="evenodd" d="M250 65.2656L189.516 99.0497V120.886L250 65.2656Z" fill="black" />
                                        <path fill-rule="evenodd" clip-rule="evenodd" d="M12.2787 1.18923L125 70.3075V136.87L0 65.2465V8.06814C0 3.61223 3.61061 0 8.06452 0C9.552 0 11.0105 0.411583 12.2787 1.18923Z" fill="currentColor" />
                                        <path fill-rule="evenodd" clip-rule="evenodd" d="M12.2787 1.18923L125 70.3075V136.87L0 65.2465V8.06814C0 3.61223 3.61061 0 8.06452 0C9.552 0 11.0105 0.411583 12.2787 1.18923Z" fill="white" fill-opacity="0.15" />
                                        <path fill-rule="evenodd" clip-rule="evenodd" d="M237.721 1.18923L125 70.3075V136.87L250 65.2465V8.06814C250 3.61223 246.389 0 241.935 0C240.448 0 238.99 0.411583 237.721 1.18923Z" fill="currentColor" />
                                        <path fill-rule="evenodd" clip-rule="evenodd" d="M237.721 1.18923L125 70.3075V136.87L250 65.2465V8.06814C250 3.61223 246.389 0 241.935 0C240.448 0 238.99 0.411583 237.721 1.18923Z" fill="white" fill-opacity="0.3" />
                                    </svg>
                                </span>
                            </span>
                            <span class="app-brand-text demo menu-text fw-semibold ms-2">Materio</span>
                        </a>
                    </div>

                    <div class="menu-inner-shadow"></div>

                    <ul class="menu-inner py-1" style="overflow:auto;scrollbar-width:none;">
                        @if (role == "5") // Purchase Requisition User
                        {
                            <li class="menu-item @(currentAction.Contains("PurchaseRequisition") ? "active open" : "")">
                                <a href="javascript:void(0);" class="menu-link menu-toggle">
                                    <i class="menu-icon tf-icons bi bi-layout-text-sidebar"></i>
                                    <div data-i18n="Purchase Requisition">Purchase Requisition</div>
                                </a>
                                <ul class="menu-sub">
                                    <li class="menu-item @(currentAction == "CreatePRADDItemPSM" ? "active" : "")">
                                        <a href="@Url.Action("CreatePRADDItemPSM", "Purchase")" class="menu-link">
                                            <i class="menu-icon tf-icons bi bi-box"></i>
                                            <div data-i18n="Stock Requirement">Stock Requirement</div>
                                        </a>
                                    </li>
                                    <li class="menu-item @(currentAction == "AllRequisitionSP" ? "active" : "")">
                                        <a href="@Url.Action("AllRequisitionSP", "Purchase")" class="menu-link">
                                            <i class="menu-icon tf-icons bi bi-collection"></i>
                                            <div data-i18n="All Requisition">All Requisition</div>
                                        </a>
                                    </li>
                                </ul>
                            </li>
                        }

                        @if (role == "6") // RFQ User
                        {
                            <li class="menu-item @(currentAction.Contains("RFQ") ? "active open" : "")">
                                <a href="javascript:void(0);" class="menu-link menu-toggle">
                                    <i class="menu-icon tf-icons bi bi-file-earmark-text"></i>
                                    <div data-i18n="Request for Quotation">Request for Quotation</div>
                                </a>
                                <ul class="menu-sub">
                                    <li class="menu-item @(currentAction == "QuotationSJ" ? "active" : "")">
                                        <a href="@Url.Action("QuotationSJ", "Purchase")" class="menu-link">
                                            <i class="menu-icon tf-icons bi bi-list-ul"></i>
                                            <div data-i18n="All RFQ">All RFQ</div>
                                        </a>
                                    </li>
                                </ul>
                            </li>
                        }

                        @if (role == "7") // Supplier Quotation User
                        {
                            <li class="menu-item @(currentAction.Contains("Supplier") ? "active open" : "")">
                                <a href="javascript:void(0);" class="menu-link menu-toggle">
                                    <i class="menu-icon tf-icons bi bi-briefcase"></i>
                                    <div data-i18n="Supplier Quotation">Supplier Quotation</div>
                                </a>
                                <ul class="menu-sub">
                                    <li class="menu-item @(currentAction.Contains("AllRQ") ? "active" : "")">
                                        <a href="@Url.Action("ShowAllRFQsVNK", "Purchase")" class="menu-link">
                                            <i class="menu-icon tf-icons bi bi-collection"></i>
                                            <div data-i18n="All RQ">All RQ</div>
                                        </a>
                                    </li>
                                </ul>
                            </li>
                        }

                        @if (role == "8") // Purchase Manager
                        {
                            <li class="menu-item @(currentAction.Contains("PRManager") || currentAction.Contains("Purchase") ? "active open" : "")">
                                <a href="javascript:void(0);" class="menu-link menu-toggle">
                                    <i class="menu-icon tf-icons bi bi-speedometer"></i>
                                    <div data-i18n="Manager Dashboard">Manager Dashboard</div>
                                </a>
                                <ul class="menu-sub">
                                    <li class="menu-item @(ViewContext.RouteData.Values["action"].ToString() == "UserDashboardPRK" ? "active" : "")">
                                        <a href="@Url.Action("UserDashboardPRK", "Purchase")" class="menu-link">
                                            <div data-i18n="Purchase Dashboard">Purchase Dashboard</div>
                                        </a>
                                    </li>
                                    <li class="menu-item @(currentAction.Contains("PurchaseRequisition") ? "active" : "")">
                                        <a href="@Url.Action("ShowPendingPRPRK", "Purchase")" class="menu-link">
                                            <i class="menu-icon tf-icons bi bi-bag"></i>
                                            <div data-i18n="Purchase Requisition">Purchase Requisition</div>
                                        </a>
                                    </li>
                                    <li class="menu-item @(currentAction.Contains("SupplierQuotation") ? "active" : "")">
                                        <a href="@Url.Action("SupplierQuotationAMG", "Purchase")" class="menu-link">
                                            <i class="menu-icon tf-icons bi bi-briefcase"></i>
                                            <div data-i18n="Supplier Quotation">Supplier Quotation</div>
                                        </a>
                                    </li>
                                    <li class="menu-item @(currentAction.Contains("PurchaseOrder") ? "active" : "")">
                                        <a href="@Url.Action("PurchaseOrdersVNK", "Purchase")" class="menu-link">
                                            <i class="menu-icon tf-icons bi bi-cart-check"></i>
                                            <div data-i18n="Purchase Order">Purchase Order</div>
                                        </a>
                                    </li>
                                    <li class="menu-item @(currentAction.Contains("Master") ? "active" : "")">
                                        <a href="@Url.Action("VenderManagementOK", "Purchase")" class="menu-link">
                                            <i class="menu-icon tf-icons bi bi-people"></i>
                                            <div data-i18n="Vendor Management">Vendor Management</div>
                                        </a>
                                    </li>
                                </ul>
                            </li>

                            <li class="menu-item @(currentAction.Contains("Reports") ? "active open" : "")">
                                <a href="javascript:void(0);" class="menu-link menu-toggle">
                                    <i class="menu-icon tf-icons bi bi-bar-chart-line"></i>
                                    <div data-i18n="Reports">Reports</div>
                                </a>
                                <ul class="menu-sub">
                                    <li class="menu-item @(currentAction == "PurchaseRequestTableAT" ? "active" : "")">
                                        <a href="@Url.Action("PurchaseRequestTableAT", "Purchase")" class="menu-link">
                                            <i class="menu-icon tf-icons bi bi-file-earmark-text"></i>
                                            <div data-i18n="PR Reports">PR Reports</div>
                                        </a>
                                    </li>
                                    <li class="menu-item @(currentAction == "RFQReportAT" ? "active" : "")">
                                        <a href="@Url.Action("RFQReportAT", "Purchase")" class="menu-link">
                                            <i class="menu-icon tf-icons bi bi-file-earmark-text"></i>
                                            <div data-i18n="RFQ Reports">RFQ Reports</div>
                                        </a>
                                    </li>
                                    <li class="menu-item @(currentAction == "PurchaseOrderReportAT" ? "active" : "")">
                                        <a href="@Url.Action("PurchaseOrderReportAT", "Purchase")" class="menu-link">
                                            <i class="menu-icon tf-icons bi bi-file-earmark-text"></i>
                                            <div data-i18n="PO Reports">PO Reports</div>
                                        </a>
                                    </li>
                                </ul>
                            </li>
                        }

                        @if (role == "9") // PO User
                        {
                            <li class="menu-item @(currentAction.Contains("POUser") || currentAction.Contains("PurchaseOrder") ? "active open" : "")">
                                <a href="javascript:void(0);" class="menu-link menu-toggle">
                                    <i class="menu-icon tf-icons bi bi-cart4"></i>
                                    <div data-i18n="PO User Dashboard">PO User Dashboard</div>
                                </a>
                                <ul class="menu-sub">
                                    <li class="menu-item @(currentAction == "SelectedQuotationListShowOK" ? "active" : "")">
                                        <a href="@Url.Action("SelectedQuotationListShowOK", "Purchase")" class="menu-link">
                                            <i class="menu-icon tf-icons bi bi-inbox"></i>
                                            <div data-i18n="Receive Quotation">Receive Quotation</div>
                                        </a>
                                    </li>
                                    <li class="menu-item @(currentAction == "PurchaseOrederHistoryOK" ? "active" : "")">
                                        <a href="@Url.Action("PurchaseOrederHistoryOK", "Purchase")" class="menu-link">
                                            <i class="menu-icon tf-icons bi bi-clock-history"></i>
                                            <div data-i18n="Purchase Order History">Purchase Order History</div>
                                        </a>
                                    </li>
                                </ul>
                            </li>
                        }

                        @if (role == "2" || role == "3" || role == "4") // Inventory Roles
                        {
                            <li class="menu-item @(currentAction == "Index" ? "active" : "")">
                                <a href="@Url.Action("Index", "Inventory")" class="menu-link">
                                    <i class="menu-icon tf-icons bi bi-speedometer2"></i>
                                    <div data-i18n="Inventory Dashboard">Inventory Dashboard</div>
                                </a>
                            </li>

                            <li class="menu-item @(currentAction.Contains("Item") || currentAction.Contains("AssignBin") ? "active open" : "")">
                                <a href="javascript:void(0);" class="menu-link menu-toggle">
                                    <i class="menu-icon tf-icons bi bi-gear"></i>
                                    <div data-i18n="Master Data">Master Data</div>
                                </a>
                                <ul class="menu-sub">
                                    <li class="menu-item @(currentAction == "ItemMasterOJ" ? "active" : "")">
                                        <a href="@Url.Action("ItemMasterOJ", "Inventory")" class="menu-link">
                                            <i class="menu-icon tf-icons bi bi-box-seam"></i>
                                            <div data-i18n="Item Master">Item Master</div>
                                        </a>
                                    </li>
                                    <li class="menu-item @(currentAction == "CategorySSG" ? "active" : "")">
                                        <a href="@Url.Action("CategorySSG", "Inventory")" class="menu-link">
                                            <i class="menu-icon tf-icons bi bi-tags"></i>
                                            <div data-i18n="Item Category">Item Category</div>
                                        </a>
                                    </li>
                                    <li class="menu-item @(currentAction == "WHIndex" ? "active" : "")">
                                        <a href="@Url.Action("WHIndex", "Inventory")" class="menu-link">
                                            <i class="menu-icon tf-icons bi bi-grid-3x3-gap"></i>
                                            <div data-i18n="Assign Bin">Assign Bin</div>
                                        </a>
                                    </li>
                                </ul>
                            </li>

                            <li class="menu-item @(currentAction.Contains("ReceiveMaterial") || currentAction.Contains("IssueInHouse") ? "active open" : "")">
                                <a href="javascript:void(0);" class="menu-link menu-toggle">
                                    <i class="menu-icon tf-icons bi bi-arrow-left-right"></i>
                                    <div data-i18n="Transaction">Transaction</div>
                                </a>
                                <ul class="menu-sub">
                                    <li class="menu-item @(currentAction == "ReceiveMaterialDRB" ? "active" : "")">
                                        <a href="@Url.Action("ReceiveMaterialDRB", "Inventory")" class="menu-link">
                                            <i class="menu-icon tf-icons bi bi-download"></i>
                                            <div data-i18n="Receive Material">Receive Material</div>
                                        </a>
                                    </li>
                                    <li class="menu-item @(currentAction == "IssueInHouseDRB" ? "active" : "")">
                                        <a href="@Url.Action("IssueInHouseDRB", "Inventory")" class="menu-link">
                                            <i class="menu-icon tf-icons bi bi-upload"></i>
                                            <div data-i18n="Issue In House">Issue In House</div>
                                        </a>
                                    </li>
                                </ul>
                            </li>

                            <li class="menu-item @(currentAction == "StocksCheakLM" ? "active" : "")">
                                <a href="@Url.Action("StocksCheakLM", "Inventory")" class="menu-link">
                                    <i class="menu-icon tf-icons bi bi-clipboard-check"></i>
                                    <div data-i18n="Stock Check">Stock Check</div>
                                </a>
                            </li>

                            <li class="menu-item @(currentAction.Contains("StockPlanning") || currentAction.Contains("Analyze") || currentAction.Contains("ItemStockRefill") || currentAction.Contains("JustInTime") || currentAction.Contains("MRP") ? "active open" : "")">
                                <a href="javascript:void(0);" class="menu-link menu-toggle">
                                    <i class="menu-icon tf-icons bi bi-bar-chart"></i>
                                    <div data-i18n="Stock Planning">Stock Planning</div>
                                </a>
                                <ul class="menu-sub">
                                    <li class="menu-item @(currentAction == "ShowStocklevelMHB" ? "active" : "")">
                                        <a href="@Url.Action("ShowStocklevelMHB", "Inventory")" class="menu-link">
                                            <i class="menu-icon tf-icons bi bi-graph-up"></i>
                                            <div data-i18n="Analyze">Analyze</div>
                                        </a>
                                    </li>
                                    <li class="menu-item @(currentAction == "JITStockMHB" ? "active" : "")">
                                        <a href="@Url.Action("JITStockMHB", "Inventory")" class="menu-link">
                                            <i class="menu-icon tf-icons bi bi-clock-history"></i>
                                            <div data-i18n="Just In Time">Just In Time</div>
                                        </a>
                                    </li>
                                    <li class="menu-item @(currentAction == "ISRStockMHB" ? "active" : "")">
                                        <a href="@Url.Action("ISRStockMHB", "Inventory")" class="menu-link">
                                            <i class="menu-icon tf-icons bi bi-clock-history"></i>
                                            <div data-i18n="ISR Stock">ISR Stock</div>
                                        </a>
                                    </li>
                                    <li class="menu-item @(currentAction == "NewplanMHB" ? "active" : "")">
                                        <a href="@Url.Action("NewplanMHB", "Inventory")" class="menu-link">
                                            <i class="menu-icon tf-icons bi bi-cash-stack"></i>
                                            <div data-i18n="MRP">MRP</div>
                                        </a>
                                    </li>
                                    <li class="menu-item @(currentAction == "ManagerApprovalMHB" ? "active" : "")">
                                        <a href="@Url.Action("ManagerApprovalMHB", "Inventory")" class="menu-link">
                                            <i class="menu-icon tf-icons bi bi-person-check"></i>
                                            <div data-i18n="Manager Approval">Manager Approval</div>
                                        </a>
                                    </li>
                                    <li class="menu-item @(currentAction == "ReqMasterRHK" ? "active" : "")">
                                        <a href="@Url.Action("ReqMasterRHK", "Inventory")" class="menu-link">
                                            <i class="menu-icon tf-icons bi bi-list-check"></i>
                                            <div data-i18n="Requirement List">Requirement List</div>
                                        </a>
                                    </li>
                                    <li class="menu-item @(currentAction == "StockMasterRHK" ? "active" : "")">
                                        <a href="@Url.Action("StockMasterRHK", "Inventory")" class="menu-link">
                                            <i class="menu-icon tf-icons bi bi-bar-chart-steps"></i>
                                            <div data-i18n="StockPlan List">StockPlan List</div>
                                        </a>
                                    </li>
                                </ul>
                            </li>

                            <li class="menu-item @(currentAction == "CurrentStockReportDataAMG" ? "active" : "")">
                                <a href="@Url.Action("CurrentStockReportDataAMG", "Inventory")" class="menu-link">
                                    <i class="menu-icon tf-icons bi bi-file-earmark-text"></i>
                                    <div data-i18n="Reports">Reports</div>
                                </a>
                            </li>
                        }

                        @if (role == "10" || role == "11" || role == "12") // GRN Roles
                        {
                            <li class="menu-item @(currentAction == "GRNDashboardRHK" ? "active" : "")">
                                <a href="@Url.Action("GRNDashboardRHK", "GRN")" class="menu-link">
                                    <i class="menu-icon tf-icons bi bi-speedometer2"></i>
                                    <div data-i18n="Dashboard">Dashboard</div>
                                </a>
                            </li>

                            <li class="menu-item @(currentAction.Contains("GRNEntry") || currentAction.Contains("ReturnGood") ? "active open" : "")">
                                <a href="javascript:void(0);" class="menu-link menu-toggle">
                                    <i class="menu-icon tf-icons bi bi-arrow-left-right"></i>
                                    <div data-i18n="Transaction">Transaction</div>
                                </a>
                                <ul class="menu-sub">
                                    <li class="menu-item @(currentAction == "GRNSSG" ? "active" : "")">
                                        <a href="@Url.Action("GRNSSG", "GRN")" class="menu-link">
                                            <i class="menu-icon tf-icons bi bi-download"></i>
                                            <div data-i18n="GRN Entry">GRN Entry</div>
                                        </a>
                                    </li>
                                    <li class="menu-item @(currentAction == "RejectedGoods" ? "active" : "")">
                                        <a href="@Url.Action("RejectedGoods", "GRN")" class="menu-link">
                                            <i class="menu-icon tf-icons bi bi-upload"></i>
                                            <div data-i18n="Return Good">Return Good</div>
                                        </a>
                                    </li>
                                </ul>
                            </li>

                            <li class="menu-item @(currentAction == "GRNSummaryReportPSM" ? "active" : "")">
                                <a href="@Url.Action("GRNSummaryReportPSM", "GRN")" class="menu-link">
                                    <i class="menu-icon tf-icons bi bi-file-earmark-text"></i>
                                    <div data-i18n="Reports">Reports</div>
                                </a>
                            </li>
                        }

                        @if (role == "13" || role == "14" || role == "15") // Quality Check Roles
                        {
                            <li class="menu-item @(currentAction == "QCheckDashboardNAM" ? "active" : "")">
                                <a href="@Url.Action("QCheckDashboardNAM", "Quality")" class="menu-link">
                                    <i class="menu-icon tf-icons bi bi-speedometer2"></i>
                                    <div data-i18n="Dashboard">Dashboard</div>
                                </a>
                            </li>

                            <li class="menu-item @(currentAction == "IndexRG" ? "active" : "")">
                                <a href="@Url.Action("IndexRG", "Quality")" class="menu-link">
                                    <i class="menu-icon tf-icons bi bi-check2-square"></i>
                                    <div data-i18n="Check Quality">Check Quality</div>
                                </a>
                            </li>

                            <li class="menu-item @(currentAction == "QalityCheackReports" ? "active" : "")">
                                <a href="@Url.Action("QalityCheackReports", "Quality")" class="menu-link">
                                    <i class="menu-icon tf-icons bi bi-file-earmark-text"></i>
                                    <div data-i18n="Reports">Reports</div>
                                </a>
                            </li>
                        }
                    </ul>
                </aside>
                <!-- / Menu -->

                <!-- Layout container -->
                <div class="layout-page">
                    <!-- Navbar -->

                    <nav class="layout-navbar px-5 my-1 container-fluid navbar-detached navbar navbar-expand-xl align-items-center bg-navbar-theme"
                         id="layout-navbar">
                        <div class="layout-menu-toggle navbar-nav align-items-xl-center me-4 me-xl-0 d-xl-none">
                            <a class="nav-item nav-link px-0 me-xl-6" href="javascript:void(0)">
                                <i class="icon-base ri ri-menu-line icon-md"></i>
                            </a>
                        </div>

                        <div class="navbar-nav-right d-flex align-items-center justify-content-end" id="navbar-collapse">
                            <ul class="navbar-nav flex-row align-items-center ms-md-auto">
                                <!-- Notification -->
                                <li class="nav-item dropdown-notifications navbar-dropdown dropdown me-3 me-xl-1">
                                    <a class="nav-link dropdown-toggle hide-arrow btn btn-icon btn-text-secondary rounded-pill waves-effect position-relative"
                                       href="javascript:void(0);"
                                       data-bs-toggle="dropdown" aria-expanded="false">
                                        <span class="position-relative">
                                            <i class="icon-base ri ri-notification-2-line icon-22px"></i>
                                            <span id="notificationBadge"
                                                  class="badge bg-danger rounded-circle position-absolute"
                                                  style="left: 10px;width: 10px; height: 15px; font-size: 8px; display: flex; align-items: center; justify-content: center; z-index: 2000;"></span>
                                        </span>
                                    </a>

                                    <ul class="dropdown-menu dropdown-menu-end p-0">
                                        <li class="dropdown-notifications-list scrollable-container ps">
                                            <ul id="notificationItems" class="list-group list-group-flush fs-6">
                                                <li class="list-group-item text-center">Loading...</li>
                                            </ul>
                                        </li>
                                        <li class="border-top p-2 d-flex justify-content-between">
                                            <button id="btnMarkAllRead" class="btn btn-sm btn-secondary"><i class="bi bi-check2-all"></i></button>
                                            <button id="btnViewAllNotifications" class="btn btn-sm btn-primary">View all</button>
                                        </li>
                                    </ul>
                                </li>
                                <!--/ Notification -->
                                <!-- User -->
                                <li class="nav-item navbar-dropdown dropdown-user dropdown">
                                    <a class="nav-link dropdown-toggle hide-arrow p-0"
                                       href="javascript:void(0);"
                                       data-bs-toggle="dropdown">
                                        <div class="avatar avatar-online">
                                            <img src="~/Content/images/avatars/1.png" alt="" id="layout-profile-photo" class="rounded-circle" />
                                        </div>
                                    </a>
                                    <ul class="dropdown-menu dropdown-menu-end">
                                        <li>
                                            <a class="dropdown-item" href="#">
                                                <div class="d-flex">
                                                    <div class="flex-shrink-0 me-3">
                                                        <div class="avatar avatar-online">
                                                            <img src="~/Content/images/avatars/1.png" id="layout-another-photo" alt="" class="w-px-40 h-auto rounded-circle" />
                                                        </div>
                                                    </div>
                                                    <div class="flex-grow-1">
                                                        <h6 id="layout-username" class="mb-0">John Doe</h6>
                                                        <small id="layout-role" class="text-body-secondary">Admin</small>
                                                    </div>
                                                </div>
                                            </a>
                                        </li>
                                        <li>
                                            <div class="dropdown-divider my-1"></div>
                                        </li>
                                        <li>
                                            <a class="dropdown-item" href="@Url.Action("UserProfile",currentController)">
                                                <i class="icon-base ri ri-user-line icon-md me-3"></i>
                                                <span>My Profile</span>
                                            </a>
                                        </li>
                                        <li>
                                            <a class="dropdown-item" href="@($"{Url.Action("UserProfile", currentController)}#update-profile")">
                                                <i class="icon-base ri ri-settings-4-line icon-md me-3"></i>
                                                <span>Update Profile</span>
                                            </a>
                                        </li>
                                        <li>
                                            <div class="dropdown-divider my-1"></div>
                                        </li>
                                        <li>
                                            <div class="d-grid px-4 pt-2 pb-1">
                                                <a class="btn btn-danger d-flex" href="@Url.Action("Logout","Account")">
                                                    <small class="align-middle">Logout</small>
                                                    <i class="ri ri-logout-box-r-line ms-2 ri-xs"></i>
                                                </a>
                                            </div>
                                        </li>
                                    </ul>
                                </li>
                                <!--/ User -->
                            </ul>
                        </div>
                    </nav>

                    <!-- / Navbar -->
                    <!-- Content wrapper -->
                    <div class="content-wrapper scroll-container">

                        @RenderBody()

                    </div>
                    <!-- Content wrapper -->
                </div>
                <!-- / Layout page -->
            </div>

            <!-- Overlay -->
            <div class="layout-overlay layout-menu-toggle"></div>
        </div>
        <!-- / Layout wrapper -->
        <!-- Enhanced Theme Switcher Script with Menu/Sidebar Support -->
        <script>
        // Menu toggle functionality
        document.addEventListener('DOMContentLoaded', function () {

            var roleid = '@role';
            var controllerName = '@currentController';

            if (roleid === '13' || roleid === '14' || roleid === '15') {
                if (controllerName !== 'Quality') {
                    window.location.href = '/Account/Logout';
                }
            }

            if (roleid === '10' || roleid === '11' || roleid === '12') {
                if (controllerName !== 'GRN') {
                    window.location.href = '/Account/Logout';
                }
            }

            if (roleid === '2' || roleid === '3' || roleid === '4') {
                if (controllerName !== 'Inventory') {
                    window.location.href = '/Account/Logout';
                }
            }

            if (roleid === '5' || roleid === '6' || roleid === '7' || roleid === '8' || roleid === '9') {
                if (controllerName !== 'Purchase') {
                    window.location.href = '/Account/Logout';
                }
            }

            const menuToggle = document.querySelector('.layout-menu-toggle');
            const menu = document.querySelector('.layout-menu');
            const overlay = document.querySelector('.layout-overlay');

            if (menuToggle && menu && overlay) {
                menuToggle.addEventListener('click', function (e) {
                    e.preventDefault();

                    // Toggle menu visibility
                    menu.classList.toggle('layout-menu-hidden');

                    // Toggle overlay
                    overlay.classList.toggle('show');

                    // Store menu state in localStorage
                    const isHidden = menu.classList.contains('layout-menu-hidden');
                    localStorage.setItem('menuHidden', isHidden);
                });

                // Close menu when clicking overlay
                overlay.addEventListener('click', function () {
                    menu.classList.add('layout-menu-hidden');
                    overlay.classList.remove('show');
                    localStorage.setItem('menuHidden', true);
                });

                // Check saved state from localStorage
                const menuHidden = localStorage.getItem('menuHidden') === 'true';
                if (menuHidden) {
                    menu.classList.add('layout-menu-hidden');
                    overlay.classList.add('show');
                }
            }

            // Handle window resize
            function handleResize() {
                const menu = document.querySelector('.layout-menu');
                const overlay = document.querySelector('.layout-overlay');

                if (window.innerWidth >= 1200) { // Desktop
                    menu?.classList.remove('layout-menu-hidden');
                    overlay?.classList.remove('show');
                } else { // Mobile
                    const menuHidden = localStorage.getItem('menuHidden') === 'true';
                    if (menuHidden) {
                        menu?.classList.add('layout-menu-hidden');
                    }
                }
            }

            window.addEventListener('resize', handleResize);
            handleResize(); // Initial check
        });


        $(document).ready(function () {

            // Body and general colors
            document.documentElement.style.setProperty('--body-bg', '#f5f5f9');
            document.documentElement.style.setProperty('--navbar-bg', '#ffffff');
            document.documentElement.style.setProperty('--card-bg', '#ffffff');
            document.documentElement.style.setProperty('--card-text', '#6f6b7d');

            // Sidebar/menu specific colors
            document.documentElement.style.setProperty('--sidebar-bg', '#ffffff');
            document.documentElement.style.setProperty('--sidebar-text', '#6f6b7d');
            document.documentElement.style.setProperty('--menu-item-active-bg', 'rgba(105, 108, 255, 0.16)');
            document.documentElement.style.setProperty('--menu-item-active-text', '#000000');
            document.documentElement.style.setProperty('--menu-item-hover-bg', 'rgba(105, 108, 255, 0.08)');

            // Remove dark mode classes from sidebar
            const menu = document.querySelector('.layout-menu');
            menu.classList.add('bg-menu-theme');

            // Load User Info
            $.ajax({
                url: '@Url.Action("GetUserInfo", "Account")',
                method: 'GET',
                success: function (res) {
                    if (res.success) {
                        UserInfo = res;
                        var defaultPhoto = '@Url.Content("~/Content/images/avatars/1.png")';
                        $('#layout-username').text(res.userName);
                        $('#layout-department').text(res.department);
                        $('#layout-role').text(res.role);
                        $('#layout-profile-photo').attr('src', res.profilePhoto || defaultPhoto);
                        $('#layout-another-photo').attr('src', res.profilePhoto || defaultPhoto);
                    } else {
                        window.location.href = '/Account/MainLogin';
                    }
                },
                error: function () {
                    window.location.href = '/Account/MainLogin';
                }
            });

            fetchNotifications();
            setInterval(fetchNotifications, 5000);

            async function fetchNotifications() {
                try {
                    const notifications = await $.ajax({
                        url: '/Account/GetNotifications',
                        type: 'GET'
                    });

                    const $list = $('#notificationItems');
                    $list.empty();
                    updateNotificationBadge(notifications.length);

                    if (notifications.length > 0) {
                        notifications.forEach(n => {
                            const item = `
                    <li class="list-group-item list-group-item-action dropdown-notifications-item waves-effect d-flex justify-content-between align-items-center">
                        <span>${n.NotificationMessage}</span>
                        <button class="btn btn-sm btn-link text-decoration-none mark-read" data-id="${n.NotificationId}"><i class="bi bi-check2-all"></i></button>
                    </li>`;
                            $list.append(item);
                        });
                    } else {
                        $list.html('<li class="list-group-item text-center">No new notifications</li>');
                    }
                } catch (err) { console.error(err); }
            }

            function updateNotificationBadge(count) {
                if (count > 0) {
                    $("#notificationBadge").text(count).show();
                } else {
                    $("#notificationBadge").hide();
                }
            }

            $(document).on('click', '.mark-read', async function () {
                const id = $(this).data('id');
                await $.post('/Account/MarkAsRead', { id: id });
                fetchNotifications();
            });

            $('#btnMarkAllRead').click(async function () {
                await $.post('/Account/MarkAllAsRead');
                fetchNotifications();
            });

            $('#btnViewAllNotifications').click(async function () {
                $('#dynamicNotificationsModal').remove(); // remove existing

                const modalHtml = `
                    <div class="modal fade" id="dynamicNotificationsModal" tabindex="-1" aria-hidden="true">
                        <div class="modal-dialog modal-lg modal-dialog-scrollable">
                            <div class="modal-content">
                                <div class="modal-header bg-primary">
                                    <h5 class="modal-title fw-semibold text-white text-center w-100 pb-4">All Notifications</h5>
                                    <button type="button" class="btn btn-close btn-close-white position-absolute top-0 end-0 m-3 fs-4" data-bs-dismiss="modal" aria-label="Close"></button>
                                </div>
                                <div class="modal-body">
                                    <ul id="allNotificationsList" class="list-group list-group-flush"></ul>
                                </div>
                                <div class="modal-footer">
                                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                                    <button id="btnModalMarkAllRead" class="btn btn-primary">Mark all as read</button>
                                </div>
                            </div>
                        </div>
                    </div>`;

                $('body').append(modalHtml);

                // Load all notifications
                const allNotifications = await $.ajax({ url: '/Account/GetAllNotifications', type: 'GET' });
                const $allList = $('#allNotificationsList');
                $allList.empty();

                if (allNotifications.length > 0) {
                    allNotifications.forEach(n => {
                        const readClass = n.IsRead ? 'text-muted' : 'fw-bold';
                        const item = `<li class="list-group-item ${readClass}">
                    <span>${n.NotificationMessage}</span>
                </li>`;
                        $allList.append(item);
                    });
                } else {
                    $allList.html('<li class="list-group-item text-center">No notifications found</li>');
                }

                const modal = new bootstrap.Modal(document.getElementById('dynamicNotificationsModal'));
                modal.show();

                // Modal Mark all as read
                $('#btnModalMarkAllRead').click(async function () {
                    await $.post('/Account/MarkAllAsRead');
                    fetchNotifications();
                    modal.hide();
                });
            });
        });
        </script>

        <!-- modal overly effect fix-->
        <script>
            document.addEventListener("DOMContentLoaded", function () {
                function moveModals() {
                    document.querySelectorAll(".modal").forEach(function (modal) {
                        if (modal.parentElement !== document.body) {
                            document.body.appendChild(modal);
                        }
                    });
                }
                // Initial run
                moveModals();

                // Watch for new modals added dynamically
                const observer = new MutationObserver(moveModals);
                observer.observe(document.body, { childList: true, subtree: true });
            });
            $(document).on("click", ".menu-toggle", function (e) {
                e.preventDefault();
                var $parent = $(this).closest(".menu-item");

                // Toggle open class
                $parent.toggleClass("open");

                // Optionally close other menus
                $parent.siblings(".menu-item.open").removeClass("open");
            });
        </script>
    </body>
</html>
